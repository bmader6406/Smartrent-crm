<div class="row">
  <div class="col-md-6">
    <div class="panel panel-default">
      <div class="panel-body">
        <table class="table table-striped table-condensed">
          <thead>
            <tr>
              <th width="70%">Individual Income</th>
              <th width="15%"># </th>
              <th>% </th>
            </tr>
          </thead>
          <tbody>
            <% group_total = @metric["income_range"].sum{|m| m.total }  %>
            <% @metric["income_range"].sort{|a, b| a.dimension.scan(/\d+/).first.to_i <=> b.dimension.scan(/\d+/).first.to_i }.each do |m| %>
              <tr>
                <td>
                  <%= m.dimension %>
                </td>
                <td>
                  <%= number_with_delimiter m.total %>
                </td>
                <td>
                  <%= conversion(m.total, group_total) %>%
                </td>
              </tr>
            <% end %>
          </tbody>
          <tfoot>
            <tr>
              <td>Total</td>
              <td colspan="2"><%= number_with_delimiter group_total %></td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
    
    <div class="panel panel-default">
      <div class="panel-body">
        <table class="table table-striped table-condensed">
          <thead>
            <tr>
              <th width="70%" style="border-bottom: 0 none;">
                Average (mean) household income
              </th>
              <th width="15%" style="border-bottom: 0 none;">
                &nbsp;
              </th>
              <th style="border-bottom: 0 none;">
                <%= number_with_delimiter avg(@metric["units.annual_income"].sum{|m| m.total*m.dimension.to_i }, @metric["units.annual_income"].sum{|m| m.total }) %>
              </th>
            </tr>
          </thead>
        </table>
      </div>
    </div>
    
    <div class="panel panel-default">
      <div class="panel-body">
        <table class="table table-striped table-condensed">
          <thead>
            <tr>
              <th width="70%">Occupations</th>
              <th width="15%"># </th>
              <th>% </th>
            </tr>
          </thead>
          <tbody>
            <% group_total = @metric["units.occupation_type"].sum{|m| m.total }  %>
            <% @metric["units.occupation_type"].sort{|a, b| b.total <=> a.total }.each do |m| %>
              <tr>
                <td>
                  <%= m.dimension %>
                </td>
                <td>
                  <%= number_with_delimiter m.total %>
                </td>
                <td>
                  <%= conversion(m.total, group_total) %>%
                </td>
              </tr>
            <% end %>
          </tbody>
          <tfoot>
            <tr>
              <td>Total</td>
              <td colspan="2"><%= number_with_delimiter group_total %></td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
    
    <div class="panel panel-default">
      <div class="panel-body">
        <table class="table table-striped table-condensed">
          <thead>
            <tr>
              <th width="70%">Minutes To Work</th>
              <th width="15%"># </th>
              <th>% </th>
            </tr>
          </thead>
          <tbody>
            <% group_total = @metric["units.minutes_to_work"].sum{|m| m.total }  %>
            <% @metric["units.minutes_to_work"].sort{|a, b| a.dimension.scan(/\d+/).first.to_i <=> b.dimension.scan(/\d+/).first.to_i }.each do |m| %>
              <tr>
                <td>
                  <%= m.dimension %>
                </td>
                <td>
                  <%= number_with_delimiter m.total %>
                </td>
                <td>
                  <%= conversion(m.total, group_total) %>%
                </td>
              </tr>
            <% end %>
          </tbody>
          <tfoot>
            <tr>
              <td>Total</td>
              <td colspan="2"><%= number_with_delimiter group_total %></td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
    
    <div class="panel panel-default">
      <div class="panel-body">
        <table class="table table-striped table-condensed">
          <thead>
            <tr>
              <th width="70%">Age Range</th>
              <th width="15%"># </th>
              <th>% </th>
            </tr>
          </thead>
          <tbody>
            <% group_total = @metric["age_range"].sum{|m| m.total }  %>
            <% @metric["age_range"].sort{|a, b| a.dimension.scan(/\d+/).first.to_i <=> b.dimension.scan(/\d+/).first.to_i }.each do |m| %>
              <tr>
                <td>
                  <%= m.dimension %>
                </td>
                <td>
                  <%= number_with_delimiter m.total %>
                </td>
                <td>
                  <%= conversion(m.total, group_total) %>%
                </td>
              </tr>
            <% end %>
          </tbody>
          <tfoot>
            <tr>
              <td>Total</td>
              <td colspan="2"><%= number_with_delimiter group_total %></td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
  </div>
  
  <div class="col-md-6">
    <div class="panel panel-default">
      <div class="panel-body">
        <table class="table table-striped table-condensed">
          <thead>
            <tr>
              <th width="70%">Occupant Status</th>
              <th width="15%"># </th>
              <th>% </th>
            </tr>
          </thead>
          <tbody>
            <% group_total = @metric["units.household_status"].sum{|m| m.total }  %>
            <% @metric["units.household_status"].sort{|a, b| b.total <=> a.total }.each do |m| %>
              <tr>
                <td>
                  <%= m.dimension %>
                </td>
                <td>
                  <%= number_with_delimiter m.total %>
                </td>
                <td>
                  <%= conversion(m.total, group_total) %>%
                </td>
              </tr>
            <% end %>
          </tbody>
          <tfoot>
            <tr>
              <td>Total</td>
              <td colspan="2"><%= number_with_delimiter group_total %></td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
    
    <div class="panel panel-default">
      <div class="panel-body">
        <table class="table table-striped table-condensed">
          <thead>
            <tr>
              <th width="70%">Average Household Size</th>
              <th width="15%"># </th>
              <th>% </th>
            </tr>
          </thead>
          <tbody>
            <% group_total = @metric["units.household_size"].sum{|m| m.total }  %>
            <% @metric["units.household_size"].sort{|a, b| b.total <=> a.total }.each do |m| %>
              <tr>
                <td>
                  <%= m.dimension %>
                </td>
                <td>
                  <%= number_with_delimiter m.total %>
                </td>
                <td>
                  <%= conversion(m.total, group_total) %>%
                </td>
              </tr>
            <% end %>
          </tbody>
          <tfoot>
            <tr>
              <td>Total</td>
              <td colspan="2"><%= number_with_delimiter group_total %></td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
    
    <div class="panel panel-default">
      <div class="panel-body">
        <table class="table table-striped table-condensed">
          <thead>
            <tr>
              <th width="70%">Number Of Cars</th>
              <th width="15%"># </th>
              <th>Ratio </th>
            </tr>
          </thead>
          <% 
            total_cars = @metric["total_cars"].sum{|m| m.total }
            total_residents = @metric["total_residents"].sum{|m| m.total }
          %>
          <tfoot>
            <tr>
              <td>Total</td>
              <td><%= number_with_delimiter total_cars %></td>
              <td><%= conversion(total_cars, total_residents) %>%</td>
            </tr>
          </tfoot>
        </table>
        
      </div>
    </div>
    
    <div class="panel panel-default">
      <div class="panel-body">
        <table class="table table-striped table-condensed">
          <thead>
            <tr>
              <th width="70%">Number Of Residents With Pets</th>
              <th width="15%"># </th>
              <th>% </th>
            </tr>
          </thead>
          <tbody>
            <% group_total = @metric["units.pet_type"].sum{|m| m.total }  %>
            <% @metric["units.pet_type"].sort{|a, b| b.total <=> a.total }.each do |m| %>
              <tr>
                <td>
                  <%= m.dimension %>
                </td>
                <td>
                  <%= number_with_delimiter m.total %>
                </td>
                <td>
                  <%= conversion(m.total, group_total) %>%
                </td>
              </tr>
            <% end %>
            <tr>
              <td>
                Total Number Residents With Pets
              </td>
              <td colspan="2">
                <%= number_with_delimiter @metric["total_residents_with_pets"].sum{|m| m.total } %>
              </td>
            </tr>
            <tr>
              <td>
                Total Number Of Pets
              </td>
              <td colspan="2">
                <%= number_with_delimiter @metric["total_pets"].sum{|m| m.total } %>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    
    <div class="panel panel-default">
      <div class="panel-body">
        <table class="table table-striped table-condensed">
          <thead>
            <tr>
              <th width="70%">Gender</th>
              <th width="15%"># </th>
              <th>% </th>
            </tr>
          </thead>
          <tbody>
            <% group_total = @metric["gender"].sum{|m| m.total }  %>
            <% @metric["gender"].sort{|a, b| b.total <=> a.total }.each do |m| %>
              <tr>
                <td>
                  <%= m.dimension %>
                </td>
                <td>
                  <%= number_with_delimiter m.total %>
                </td>
                <td>
                  <%= conversion(m.total, group_total) %>%
                </td>
              </tr>
            <% end %>
          </tbody>
          <tfoot>
            <tr>
              <td>Total</td>
              <td colspan="2"><%= number_with_delimiter group_total %></td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
    
    <div class="panel panel-default">
      <div class="panel-body">
        <table class="table table-striped table-condensed">
          <thead>
            <tr>
              <th width="70%">Transportation</th>
              <th width="15%"># </th>
              <th>% </th>
            </tr>
          </thead>
          <tbody>
            <% group_total = @metric["units.transportation_to_work"].sum{|m| m.total }  %>
            <% @metric["units.transportation_to_work"].sort{|a, b| b.total <=> a.total }.each do |m| %>
              <tr>
                <td>
                  <%= m.dimension %>
                </td>
                <td>
                  <%= number_with_delimiter m.total %>
                </td>
                <td>
                  <%= conversion(m.total, group_total) %>%
                </td>
              </tr>
            <% end %>
          </tbody>
          <tfoot>
            <tr>
              <td>Total</td>
              <td colspan="2"><%= number_with_delimiter group_total %></td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
    
    <div class="panel panel-default">
      <div class="panel-body">
        <table class="table table-striped table-condensed">
          <thead>
            <tr>
              <th width="70%">Where Moved From</th>
              <th width="15%"># </th>
              <th>% </th>
            </tr>
          </thead>
          <tbody>
            <% group_total = @metric["units.moving_from"].sum{|m| m.total }  %>
            <% @metric["units.moving_from"].sort{|a, b| b.total <=> a.total }.each do |m| %>
              <tr>
                <td>
                  <%= m.dimension %>
                </td>
                <td>
                  <%= number_with_delimiter m.total %>
                </td>
                <td>
                  <%= conversion(m.total, group_total) %>%
                </td>
              </tr>
            <% end %>
          </tbody>
          <tfoot>
            <tr>
              <td>Total</td>
              <td colspan="2"><%= number_with_delimiter group_total %></td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
    
  </div>
</div>